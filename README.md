# Text-Mining-of-Corporate-Annual-Reports
To analyze corporate financial crisis (ST situation) using textual information, with a focus on annual reports of listed companies from 2018 to 2020.

主要展示文本提取、数据清洗、文本特征构建、分类预测等内容，爬取过程省略。

**01 年报文本提取.ipynb** 

数据来源于2018-2020年深市主板、沪市主板、科创板发布的企业年报。由于爬取时分板块爬取，处理时也分块处理。以深市为例。处理完需合并文档。

根据pdf文档能否跳转的不同情况使用不同工具。主要提取“讨论与分析”章节。

**02 数据清洗.ipynb**

去除不包含“讨论与分析”的内容，截取“讨论与分析”后与下一章节前的内容。

筛选出2018-2019三年的内容，去除股票代码出现3次以上的文档。细化板块。

查看文本字符长度分布，文本过短查看源文件进行筛选，文本过长经查看没有什么问题。

**03 分词.ipynb**

去标点、去英文、使用哈工大停用词表去停用词，jieba分词。

**04 提取关键词-预训练生成词向量(金融版).ipynb**

文本过长，使用TF-IDF提取前512关键词。

bert预训练生成词向量。配置环境，使用1.15版本tf，新建jupyter notebook内核。下载预训练模型至本地，在终端调用。详见notebook。

**05 可读性语调指标.ipynb**

查阅文献确定可读性、语调等文本指标，从整体描述文本。

调用金融词典，主要使用Sentiment工具。确定指标：word_count, sentence_count, readability, pos_count, neg_count	tone

**06 标签构造-取样-训练集测试集构造.ipynb**

ST信息来源于中信证券。标签为年报下一年企业是否执行ST，执行ST则财务状况不佳。

行业信息来源于之前课程设计时同组成员爬取的class.csv，内容包括股票代码和对应的行业。首先用行业文档给已有文本数据添加行业信息。ST企业缺失的行业信息根据通达信行业对应至证监会行业，对应不上的手动添加。非ST企业缺失的行业信息标为X。

根据ST企业的行业分布，按1：1选取ST企业和非ST企业构成数据集。按1：5分测试集训练集。

**07 AE神经网络降维-lgb分类预测.ipynb**

AE神经网络自监督降维。Bert预训练输出768维，尝试降至32，64，128，256等维度，最后文档里展示的是128维。

lgb模型进行分类预测。测试集准确率75%。

**改进方向** 

特征角度。考虑加入文本相似度特征，对文本向量再进行筛选，考虑加入财务数据信息。

模型角度。lgb更细化调参。尝试使用textcnn模型，试过但不太成功有机会再试。

细化实验设计。尝试使用第1年文本特征预测第3年ST结果，尝试使用前3年文本特征预测第5年结果。
